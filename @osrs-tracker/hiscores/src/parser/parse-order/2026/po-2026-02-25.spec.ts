import { describe, expect, it } from '@jest/globals';
import { BossEnum } from '../../../models/hiscore.enum';
import { parseHiscoreString } from '../../parser';

describe('Parser with 2026-02-25 parse order', () => {
  it('should parse with Brutus', () => {
    const hiscoreString =
      '188628,2200,255380683\n184720,99,16492115\n126381,99,16776714\n97961,99,35285106\n175734,99,34309782\n270164,99,22799793\n315695,90,5397637\n363480,99,14348311\n491597,96,10013136\n537524,86,3831290\n473607,90,5585544\n612339,83,2728882\n474576,95,8771569\n284919,94,8111165\n357680,86,3793506\n286993,92,7032580\n211281,93,7300605\n349986,84,3057072\n511831,82,2454923\n141003,99,14761405\n391668,96,10064740\n420109,78,1738514\n609174,78,1762401\n339437,85,3300261\n6450,99,15663632\n-1,0\n-1,0\n-1,0\n-1,0\n-1,0\n-1,0\n-1,0\n200517,374\n337247,19\n134818,69\n187474,101\n194548,145\n161369,35\n282742,5\n226030,603\n-1,2500\n-1,0\n264247,180\n232259,546\n73969,580\n128527,320\n149513,470\n27871,136\n22023,1416\n-1,0\n213347,314\n-1,0\n416735,5\n59820,356\n50279,311\n233682,249\n358992,6\n-1,0\n-1,1\n317996,13\n-1,0\n-1,0\n138794,60\n194021,152\n417962,90\n211374,128\n205225,25\n-1,0\n-1,1\n181662,232\n268040,90\n219094,86\n165735,73\n82014,236\n606861,25\n395591,557\n-1,1\n15086,711\n42331,307\n218892,1\n-1,0\n-1,0\n-1,0\n450250,5\n-1,0\n67031,283\n-1,1\n72381,216\n33632,172\n228927,28\n-1,0\n119686,35\n306679,100\n-1,2\n167289,158\n2677,832\n-1,4\n179021,119\n-1,1\n-1,0\n-1,0\n84717,896\n240752,17\n-1,0\n-1,0\n-1,1\n124168,52\n260233,7\n-1,0\n266105,330\n403174,352\n-1,0\n79842,198\n288606,312';

    const hiscore = parseHiscoreString(hiscoreString, new Date(2026, 1, 25, 12));

    expect(hiscore.bosses[BossEnum.BarrowsChests]).toEqual({
      name: BossEnum.BarrowsChests,
      rank: 213347,
      score: 314,
    });
    expect(hiscore.bosses[BossEnum.Brutus]).toEqual({
      name: BossEnum.Brutus,
      rank: -1,
      score: 0,
    });
    expect(hiscore.bosses[BossEnum.Bryophyta]).toEqual({
      name: BossEnum.Bryophyta,
      rank: 416735,
      score: 5,
    });
  });
});
