import { describe, expect, it } from '@jest/globals';
import { BossEnum } from '../../models/hiscore.enum';
import { parseHiscoreString } from '../parser';

describe('Parser with 2025-05-14 parse order', () => {
  it('should parse Yama', () => {
    const hiscoreString =
      '491,2277,1975972047\n608,99,185896556\n1098,99,89702384\n1056,99,200000000\n597,99,200000000\n552,99,200000000\n950,99,28725335\n788,99,154586896\n12676,99,39392553\n5129,99,49279386\n4162,99,33608816\n2010,99,52103030\n1256,99,152936901\n4394,99,21322911\n8462,99,20259430\n986,99,74067447\n961,99,44648976\n5098,99,19058552\n4338,99,56090769\n395,99,106904832\n2527,99,102872313\n2831,99,30765831\n922,99,91183632\n680,99,22565497\n-1,-1\n-1,-1\n-1,-1\n-1,-1\n12353,328\n135910,4\n148,16161\n12046,437\n374,3907\n1729,2015\n30,7055\n44,1495\n104,1252\n5317,6031\n43369,2604\n9648,13184\n5959,1368\n9983,44666\n25,1489\n3987,2129\n14005,2644\n1713,813\n2399,2652\n4113,2011\n1848,2566\n2008,250\n2673,5274\n10404,880\n4683,4039\n7030,1462\n37087,60\n33733,169\n4829,662\n514,5007\n3663,1796\n27012,203\n6904,1942\n7906,2038\n7054,1935\n26676,50\n1496,2823\n3049,3528\n1101,7648\n464,4861\n17552,210\n1060,3219\n2721,4080\n49805,3405\n1094,4028\n250,5763\n13335,327\n84,101\n3068,4636\n14995,250\n3023,883\n2929,159\n3172,1169\n554,6856\n3854,1169\n7078,1228\n195,399\n3943,52\n1848,2572\n15062,637\n75371,47\n5484,1582\n2894,509\n15885,600\n571,1594\n1642,1715\n9985,779\n20572,24\n28051,1824\n19771,170\n13542,394\n2293,25\n1725,91\n820,4776\n63,14401\n1620,2166\n3779,7368\n1265,3913\n1,17\n441,4972\n8018,5829';

    const hiscore = parseHiscoreString(hiscoreString, new Date(2025, 4, 14, 12));

    expect(hiscore.bosses[BossEnum.Wintertodt]).toEqual({
      name: BossEnum.Wintertodt,
      rank: 1265,
      score: 3913,
    });
    expect(hiscore.bosses[BossEnum.Yama]).toEqual({
      name: BossEnum.Yama,
      rank: 1,
      score: 17,
    });
    expect(hiscore.bosses[BossEnum.Zalcano]).toEqual({
      name: BossEnum.Zalcano,
      rank: 441,
      score: 4972,
    });
  });
});
