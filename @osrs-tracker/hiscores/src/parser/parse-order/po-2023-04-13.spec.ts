import { describe, expect, it } from '@jest/globals';
import { BossEnum } from '../../models/hiscore.enum';
import { parseHiscoreString } from '../parser';

describe('Parser with 2023-04-13 parse order', () => {
  it('should parse new bosses', () => {
    const hiscoreString =
      '157009,2076,282447337\n196682,99,13766224\n113261,99,14935648\n16418,99,52698442\n31091,99,51693577\n52037,99,41524354\n53544,99,13089999\n36100,99,24536094\n499980,87,4084616\n257696,88,4490117\n563370,80,2104463\n369977,84,3116804\n325685,92,6735572\n321677,84,2974252\n174630,87,4317612\n219490,85,3534059\n146523,90,5555324\n214440,82,2590740\n268826,83,2716628\n340560,90,5431372\n170144,99,13139091\n180074,83,2687736\n186400,85,3510627\n188631,84,3213986\n-1,-1\n-1,-1\n-1,-1\n58874,599\n654672,3\n206308,22\n36474,313\n146964,127\n43136,63\n23109,71\n-1,-1\n-1,-1\n-1,-1\n424260,7\n157328,45\n-1,-1\n42546,10\n195445,237\n159907,6\n22026,341\n54687,24\n-1,-1\n99120,131\n26847,24\n101511,28\n163171,11\n144213,43\n27920,270\n102669,52\n158013,117\n238139,119\n154951,122\n117827,10\n219543,78\n13408,1710\n129690,77\n83638,76\n189791,5\n88843,334\n296621,430\n123384,30\n124367,57\n19751,7\n72390,64\n54230,28\n6479,283\n256223,5\n24442,136\n77607,83\n33364,121\n365640,8\n32666,20\n387541,10\n126568,9\n-1,-1\n16015,359\n3646,175\n-1,-1\n46911,71\n4318,348\n47729,1\n72795,12\n57733,115\n75187,23\n222219,237\n367691,224\n163594,10\n60182,1506';

    const hiscore = parseHiscoreString(hiscoreString, new Date(2023, 3, 14));

    expect(hiscore.bosses[BossEnum.Artio]).toEqual({ name: BossEnum.Artio, rank: 42546, score: 10 });
    expect(hiscore.bosses[BossEnum.Calvarion]).toEqual({ name: BossEnum.Calvarion, rank: 54687, score: 24 });
    expect(hiscore.bosses[BossEnum.Spindel]).toEqual({ name: BossEnum.Spindel, rank: 32666, score: 20 });
  });
});
