import { describe, expect, it } from '@jest/globals';
import { BossEnum } from '../../models/hiscore.enum';
import { parseHiscoreString } from '../parser';

describe('Parser with 2025-02-05 parse order', () => {
  it('should parse The Royal Titans', () => {
    const hiscoreString =
      '75059,2245,635975523\n86998,99,20764067\n35259,99,22938392\n5087,99,133626367\n9568,99,108070688\n21015,99,84394162\n80624,99,13128518\n11511,99,48737766\n231362,99,13123694\n62461,99,14219330\n83426,99,13297981\n177811,96,10244100\n45583,99,15187649\n163281,99,13074733\n91883,99,13065632\n157475,96,10607160\n63668,99,13216286\n140067,91,6303346\n117045,99,13212674\n12377,99,30624185\n208931,99,13371912\n172477,87,4277218\n153841,93,7327148\n48564,99,13162515\n-1,-1\n-1,-1\n15580,67\n16132,5\n-1,-1\n-1,-1\n134002,435\n-1,-1\n-1,-1\n371427,31\n398393,50\n177994,24\n3681,330\n189724,605\n-1,-1\n-1,-1\n336609,81\n1420,49207\n44390,511\n20278,1003\n132614,436\n6575,200\n367,4669\n103335,22\n652058,51\n175732,8\n93861,130\n16680,584\n27474,1735\n29061,680\n1163,893\n13940,327\n162423,32\n89168,196\n3555,1803\n22639,222\n42873,633\n57958,619\n43266,633\n113706,25\n55987,188\n255502,100\n46898,882\n43884,402\n112848,81\n139366,94\n112075,321\n191130,1442\n76963,182\n8300,850\n131104,38\n7923,18\n84498,159\n66145,28\n18643,115\n196412,8\n83302,117\n67744,170\n10219,516\n96781,102\n121523,38\n1815,80\n105913,20\n520444,30\n129637,26\n98639,254\n23133,109\n21087,305\n1,185\n23544,184\n21899,373\n1191,574\n96193,669\n55080,97\n6034,556\n895,43\n5111,53\n2998,2805\n21819,553\n220155,5\n19506,2406\n743277,121\n13241,677\n40887,2240';

    const hiscore = parseHiscoreString(hiscoreString, new Date(2025, 1, 5, 12));

    expect(hiscore.bosses[BossEnum.TheLeviathan]).toEqual({
      name: BossEnum.TheLeviathan,
      rank: 21087,
      score: 305,
    });
    expect(hiscore.bosses[BossEnum.TheRoyalTitans]).toEqual({
      name: BossEnum.TheRoyalTitans,
      rank: 1,
      score: 185,
    });
    expect(hiscore.bosses[BossEnum.TheWhisperer]).toEqual({
      name: BossEnum.TheWhisperer,
      rank: 23544,
      score: 184,
    });
  });
});
